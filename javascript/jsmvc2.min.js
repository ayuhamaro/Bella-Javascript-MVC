/***Ver 2.3.0***/var Jsmvc2=function(b){this.Ctrl={},this.CallBack={},this.Var={o:this};var c=b;$(function(){if(window[c]instanceof Jsmvc2)for(var a in window[c].Ctrl)"function"==typeof window[c].Ctrl[a]&&window[c].Ctrl[a].bind(window[c])()})};Jsmvc2.prototype.Model=function(a,b,c,d){"undefined"==typeof c&&(c={});var e=this;$.ajax({type:"POST",url:a,data:c,dataType:"json",success:function(a){"undefined"!=typeof b&&null!==b&&("object"!=typeof a&&(a=$.parseJSON(r)),"function"==typeof b?b(a,d):"string"==typeof b&&e.CallBack[b].bind(e)(a,d))},error:function(a){console.log(a)}})},Jsmvc2.prototype.View=function(a,b,c,d){var e=this;$.ajax({type:"GET",url:a,dataType:"html",success:function(a){var f=e.Render(a,b,c);"function"==typeof d&&d(f)},error:function(a){console.log(a)}})},Jsmvc2.prototype.Render=function(a,b,c){if(a=a.replace(/\t/g,""),a=a.replace(/\n/g,""),a=a.replace(/\r/g,""),null===b&&c==={})return a;var d=function(a,b){var c=a.attr("be-list");if($.isArray(b[c]===!1))return a.empty(),!1;if(0===b[c].length)return a.empty(),!1;var d=a.html(),e=d.match(/\{\{(.*?)\}\}/g);null!==e&&(e=$.map(e,function(a){var b=new RegExp("\\{\\{"+c+"\\.(.*?)\\}\\}");return a=b.exec(a),a[1]}));var f=[];for(var g in b[c][0])f.push(g);a.empty();for(var h in b[c]){var i=d;if(null!==e)for(var j in f)$.inArray(f[j],e)!==-1&&(i=i.replace(new RegExp("\\{\\{"+c+"\\."+f[j]+"\\}\\}","g"),b[c][h][f[j]]));a.append(i);var k=a.children().last();for(var j in f){var l=k.find("[be-value='"+c+"."+f[j]+"']");l.length>0&&l.html(b[c][h][f[j]])}}return!0},e=[];for(var f in c)$.isArray(c[f])===!1&&e.push(f);for(var g in e){var h=a.match(new RegExp("\\{\\{"+e[g]+"\\}\\}"));null!==h&&(a=a.replace(new RegExp("\\{\\{"+e[g]+"\\}\\}","g"),c[e[g]]))}if(null===b)return a;var i=$("#"+b);i.html(a);for(var g in e){var j=i.find("[be-value="+e[g]+"]");j.length>0&&j.html(c[e[g]])}var k=[],l=i.find("[be-list]");l.each(function(){var a=$(this).attr("be-list");$.inArray(a,k)===-1&&k.push(a)});for(var m in k){var n=i.find("[be-list="+k[m]+"]");n.each(function(){d($(this),c)})}return i.html()},Jsmvc2.prototype.Func={o:this},Jsmvc2.prototype.Func.enterBindBtnClick=function(a,b){$(a).keydown(function(a){13===a.keyCode&&$("#"+b).click()})},Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d?this:a||this,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e});
