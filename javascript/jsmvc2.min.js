/***Ver 2.2.0***/var Jsmvc2=function BellaJMVC2(name){this.Ctrl={o:this};this.CallBack={o:this};this.Var={o:this};var objName=name;$(function(){if(window[objName]instanceof Jsmvc2){window[objName].Init()}})};Jsmvc2.prototype.Model=function(uri,callBack,data,extra){if(typeof(data)==='undefined'){data={}}var self=this;$.ajax({"type":"POST","url":uri,"data":data,"dataType":"json","success":function(json){if(typeof(callBack)!=='undefined'&&callBack!==null){if(typeof(json)!=='object'){json=$.parseJSON(r)}if(typeof(callBack)==='function'){callBack(json,extra)}else if(typeof(callBack)==='string'){self.CallBack[callBack](json,extra)}}},"error":function(r){console.log(r)}})};Jsmvc2.prototype.View=function(uri,placeId,data,callBack){var self=this;$.ajax({"type":"GET","url":uri,"dataType":"html","success":function(viewHtml){var rendered=self.Render(viewHtml,placeId,data);if(typeof(callBack)==='function'){callBack(rendered)}},"error":function(r){console.log(r)}})};Jsmvc2.prototype.Render=function(viewHtml,placeId,data){viewHtml=viewHtml.replace(/\t/g,'');viewHtml=viewHtml.replace(/\n/g,'');viewHtml=viewHtml.replace(/\r/g,'');if(placeId===null&&data==={}){return viewHtml}var viewCreateList=function(listObj,data){var listAttrValue=listObj.attr('be-list');if($.isArray(data[listAttrValue]===false)){listObj.empty();return false}if(data[listAttrValue].length===0){listObj.empty();return false}var itemHtml=listObj.html();var itemPlaceholderNames=itemHtml.match(/\{\{(.*?)\}\}/g);if(itemPlaceholderNames!==null){itemPlaceholderNames=$.map(itemPlaceholderNames,function(val){var pattern=new RegExp('\\{\\{'+listAttrValue+'\\.(.*?)\\}\\}');val=pattern.exec(val);return val[1]})}var keyNames=[];for(var listAttrValueIndex in data[listAttrValue][0]){keyNames.push(listAttrValueIndex)}listObj.empty();for(var rowIndex in data[listAttrValue]){var rowHtml=itemHtml;if(itemPlaceholderNames!==null){for(var key in keyNames){if($.inArray(keyNames[key],itemPlaceholderNames)!==-1){rowHtml=rowHtml.replace(new RegExp('\\{\\{'+listAttrValue+'\\.'+keyNames[key]+'\\}\\}','g'),data[listAttrValue][rowIndex][keyNames[key]])}}}listObj.append(rowHtml);var nowRow=listObj.children().last();for(var key in keyNames){var itemValue=nowRow.find('[be-value=\''+listAttrValue+'.'+keyNames[key]+'\']');if(itemValue.length>0){itemValue.html(data[listAttrValue][rowIndex][keyNames[key]])}}}return true};var valueNames=[];for(var dataIndex in data){if($.isArray(data[dataIndex])===false){valueNames.push(dataIndex)}}for(var valueIndex in valueNames){var valuePlaceholderNames=viewHtml.match(new RegExp('\\{\\{'+valueNames[valueIndex]+'\\}\\}'));if(valuePlaceholderNames!==null){viewHtml=viewHtml.replace(new RegExp('\\{\\{'+valueNames[valueIndex]+'\\}\\}','g'),data[valueNames[valueIndex]])}}if(placeId===null){return viewHtml}var place=$('#'+placeId);place.html(viewHtml);for(var valueIndex in valueNames){var value=place.find('[be-value='+valueNames[valueIndex]+']');if(value.length>0){value.html(data[valueNames[valueIndex]])}}var listNames=[];var listObjs=place.find('[be-list]');listObjs.each(function(){var listForAttr=$(this).attr('be-list');if($.inArray(listForAttr,listNames)===-1){listNames.push(listForAttr)}});for(var listIndex in listNames){var listObj=place.find('[be-list='+listNames[listIndex]+']');listObj.each(function(){viewCreateList($(this),data)})}return place.html()};Jsmvc2.prototype.Init=function(){for(var i in this.Ctrl){if(i.substring(0,2)=='__'){this.Ctrl[i]()}}};Jsmvc2.prototype.Func={o:this};Jsmvc2.prototype.Func.enterBindBtnClick=function(selector,submitButtonId){$(selector).keydown(function(e){if(e.keyCode===13){$('#'+submitButtonId).click()}})};
